{"version":3,"sources":["file:///D:/CongViec_HocTap/CongTy/Amobear/SupermarketTycoon3D/assets/Scripts/GamePlay/HideMask.ts"],"names":["_decorator","Camera","Component","geometry","Node","PhysicsSystem","GameInfo","UIGameController","CONST","GameController","SoundController","ccclass","property","HideMask","init","start","registerEvent","node","on","EventType","TOUCH_START","touchStart","event","isCanTouch","console","log","getRaycastResult","touchPos","ray","Ray","Cam_2D","screenPointToRay","getLocationX","getLocationY","mask","maxDistance","queryTrigger","instance","raycastClosest","raycastClosestResult","collider","name","isToStore","IsShowPopupInstall","currentSuccessClick","installHandle","currentItems","currentTotalCost","Tut_1","active","Instance","PlaySound","SoundTrack","paySound","Tut_2","NPCpaidTimes","paidSound","currentReceive","TouchArea_GiveTheChange","Tut_3","TouchArea_Banking","PcScreen_Change","PcScreen_Give","PcScreen_Receive"],"mappings":"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","sourcesContent":["import { _decorator, Camera, Component, EventTouch, geometry, log, Node, physics, Vec2, Vec3, PhysicsSystem } from 'cc';\r\n// import { IronSource } from '../AdHelper/IronSource';\r\nimport { GameInfo } from '../Const/GameInfo';\r\nimport { Utility } from '../Utils/Utility';\r\nimport { LogicGamePlay } from '../Others/HandleLogicGamePlay';\r\nimport { UIGameController } from '../Controller/UIGameController';\r\nimport { CONST } from '../Const/CONST';\r\nimport { GameController } from '../Controller/GameController';\r\nimport { SoundController } from '../Controller/SoundController';\r\nimport { IronSource } from '../AdHelper/IronSource';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n/**\r\n * Predefined variables\r\n * Name = HideMask\r\n * DateTime = Mon Aug 26 2024 09:46:25 GMT+0700 (Indochina Time)\r\n * Author = hoanghiep2001\r\n * FileBasename = HideMask.ts\r\n * FileBasenameNoExtension = HideMask\r\n * URL = db://assets/Scripts/GamePlay/HideMask.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\r\n *\r\n */\r\n\r\n\r\n@ccclass('HideMask')\r\nexport class HideMask extends Component {\r\n    @property(UIGameController)\r\n    UIGameController: UIGameController = null;\r\n    @property(GameController)\r\n    GameController: GameController = null;\r\n\r\n\r\n    @property(Camera)\r\n    Cam_2D: Camera = null;\r\n\r\n\r\n    private init(): void {\r\n\r\n    }\r\n\r\n\r\n    protected start(): void {\r\n        this.init();\r\n        this.registerEvent();\r\n    }\r\n \r\n\r\n    private registerEvent(): void {\r\n        this.node.on(Node.EventType.TOUCH_START, this.touchStart, this);\r\n    }\r\n\r\n\r\n    private touchStart(event: EventTouch): void {\r\n        if (!GameInfo.isCanTouch) return;\r\n        \r\n        // IronSource.handleIronSourcePlaySound();\r\n\r\n        // if(GameInfo.isToStore || GameInfo.IsShowPopupInstall || GameInfo.currentSuccessClick >= 4) {\r\n        //     this.GameController.installHandle();\r\n        //     return;\r\n        // }\r\n\r\n        console.log(\"ahihi\")\r\n        \r\n        this.getRaycastResult(event);\r\n    }\r\n\r\n\r\n    private getRaycastResult(touchPos: EventTouch): void {\r\n        let ray = new geometry.Ray();\r\n        this.Cam_2D.screenPointToRay(touchPos.getLocationX(), touchPos.getLocationY(), ray);\r\n        // The following parameters are optional\r\n        const mask = 0xffffffff;\r\n        const maxDistance = 10000000;\r\n        const queryTrigger = true;\r\n\r\n\r\n         console.log(\"ahihi\")\r\n\r\n        if (PhysicsSystem.instance.raycastClosest(ray, mask, maxDistance, queryTrigger)) {\r\n            const raycastClosestResult = PhysicsSystem.instance.raycastClosestResult;\r\n            // const hitPoint = raycastClosestResult.hitPoint\r\n            // const hitNormal = raycastClosestResult.hitNormal;\r\n            const collider = raycastClosestResult.collider;\r\n            // const distance = raycastClosestResult;   \r\n            \r\n            if(collider.node.name === \"Watermelon_LOD0\" \r\n                || collider.node.name === \"item_Flour\" \r\n                || collider.node.name === \"item_Toilet_Paper_LOD0\") \r\n            {\r\n\r\n\r\n console.log(\"ahihi\")\r\n\r\n\r\n                if(GameInfo.isToStore || GameInfo.IsShowPopupInstall || GameInfo.currentSuccessClick >= 4) {\r\n                    this.GameController.installHandle();\r\n                    return;\r\n                }\r\n\r\n\r\n                console.log(\"ahihi\")\r\n\r\n                GameInfo.currentItems -= 1;\r\n\r\n                if(collider.node.name === \"Watermelon_LOD0\") GameInfo.currentTotalCost += 15;\r\n                if(collider.node.name === \"item_Flour\") GameInfo.currentTotalCost += 25;\r\n                if(collider.node.name === \"item_Toilet_Paper_LOD0\") GameInfo.currentTotalCost += 20;\r\n\r\n                if(GameInfo.currentItems === 0) this.UIGameController.Tut_1.active = true;\r\n\r\n                collider.node.active = false;\r\n\r\n                SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.paySound);\r\n\r\n                this.UIGameController.Tut_2.active = false;\r\n            }\r\n\r\n\r\n            if(collider.node.name === \"Money\" \r\n                || collider.node.name === \"CC\" ) \r\n            {\r\n                GameInfo.NPCpaidTimes += 1;\r\n\r\n                collider.node.active = false;\r\n\r\n                SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.paidSound);\r\n                \r\n                this.UIGameController.Tut_1.active = false;\r\n\r\n                // payment with cash\r\n                if(collider.node.name === \"Money\") {\r\n\r\n                    GameInfo.currentReceive += 100;\r\n        \r\n                    this.UIGameController.TouchArea_GiveTheChange.active = true;\r\n\r\n                    this.UIGameController.Tut_3.active = true;\r\n                }\r\n\r\n                // payment with banking\r\n                else {\r\n                    this.UIGameController.TouchArea_Banking.active = true;\r\n\r\n                    this.UIGameController.PcScreen_Change.active = false;\r\n\r\n                    this.UIGameController.PcScreen_Give.active = false;\r\n\r\n                    this.UIGameController.PcScreen_Receive.active = false;\r\n                }\r\n \r\n            }\r\n\r\n            // log(raycastClosestResult)\r\n        }\r\n    }\r\n\r\n}\r\n"]}
{"version":3,"sources":["file:///D:/CongViec_HocTap/CongTy/Amobear/SupermarketTycoon3D/assets/Scripts/Options/PA_06/PA_06_GamePlay.ts"],"names":["_decorator","Camera","Component","easing","Node","tween","GameInfo","PA_06_Camera","SoundController","CONST","ccclass","property","PA_06_GamePlay","start","handleOpenBox","BoxOpen","Box","getChildByName","boxIdle","active","currentClickBox","Tut2","disableTut","tutIndex","Tut","timeCount","PA_06","isStartPlaying","handleStockTheShelves","currentItemStock","onBoxItems","length","airWorldPos","onAirItems","worldPosition","shelveWorldPos","onShelfItems","currentItem","Instance","PlaySound","SoundTrack","placeSound","to","smooth","delay","call","isDoneStockItem","isWin","handleShowCustomer","isShowCustomer","winSound","confetti_PS","camera3d","getComponent","goToNewPos","update","dt","isLose","CTA","isCameraMoveDone"],"mappings":"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","sourcesContent":["import { _decorator, Camera, Component, easing, fragmentText, Node, SkeletalAnimation, tween } from 'cc';\nimport { GameInfo } from '../../Const/GameInfo';\nimport { PA_06_Camera } from './PA_06_Camera';\nimport { SoundController } from '../../Controller/SoundController';\nimport { CONST } from '../../Const/CONST';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = PA_06_GamePlay\n * DateTime = Fri Jan 03 2025 10:42:49 GMT+0700 (Indochina Time)\n * Author = hoanghiep2001\n * FileBasename = PA_06_GamePlay.ts\n * FileBasenameNoExtension = PA_06_GamePlay\n * URL = db://assets/Scripts/Options/PA_06/PA_06_GamePlay.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\n *\n */\n\n@ccclass('PA_06_GamePlay')\nexport class PA_06_GamePlay extends Component {\n\n    @property(Camera)\n    camera3d: Camera = null;\n\n    @property(Node)\n    Tut: Node = null;\n    @property(Node)\n    Tut2: Node = null;\n\n    @property(Node)\n    timeCount: Node = null;\n\n    @property(Node)\n    Box: Node = null;\n\n    @property([Node])\n    onAirItems: Node[] = [];\n\n    @property([Node])\n    onShelfItems: Node[] = [];\n\n    @property([Node])\n    onBoxItems: Node[] = [];\n\n    @property(Node)\n    confetti_PS: Node = null;\n\n    @property(Node)\n    CTA: Node = null;\n\n\n    currentClickBox: number = 0;\n    currentItemStock: number = 0;\n    isDoneStockItems: boolean = false;\n\n\n    isShowCustomer: boolean = false;\n\n\n    protected start(): void {\n        // const boxParent = this.Box.parent;\n        // boxParent.getComponent(SkeletalAnimation).play();\n        // this.scheduleOnce(() => {\n        //     boxParent.getComponent(SkeletalAnimation).stop();\n        // }, 0.1);\n    }\n\n\n    public handleOpenBox(): void {\n        const BoxOpen = this.Box.getChildByName(\"BoxOpen\"),\n            boxIdle = this.Box.getChildByName(\"BoxIdle\");\n\n        BoxOpen.active = true;\n        boxIdle.active = false;\n\n        this.currentClickBox += 1;\n        this.Tut2.active = true;\n        this.disableTut(this.currentClickBox);\n    }\n\n\n    private disableTut(tutIndex: number): void {\n        if (tutIndex <= 1) this.Tut.active = false;\n        else {\n            this.Tut2.active = false\n            this.timeCount.active = true;\n            GameInfo.PA_06.isStartPlaying = true;\n        }\n    }\n\n\n    public handleStockTheShelves(): void {\n        if (this.currentItemStock >= this.onBoxItems.length) return;\n\n        const airWorldPos = this.onAirItems[this.currentItemStock].worldPosition;\n        const shelveWorldPos = this.onShelfItems[this.currentItemStock].worldPosition;\n        const currentItem = this.onBoxItems[this.currentItemStock];\n\n        this.currentItemStock += 1;\n\n        SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.placeSound);\n\n        tween(currentItem)\n            .to(0.1, { worldPosition: airWorldPos }, { easing: easing.smooth })\n            .start();\n\n        tween(currentItem)\n            .delay(0.1)\n            .to(0.1, { worldPosition: shelveWorldPos }, { easing: easing.smooth })\n            .call(() => {\n                if (this.currentItemStock >= this.onBoxItems.length) {\n                    GameInfo.PA_06.isDoneStockItem = true;\n                    this.Box.active = false;\n                    GameInfo.isWin = true;\n                }\n            })\n            .start();\n    }\n\n\n    // private showCTA(): void {\n    //     GameInfo.isWin = false;\n    // }\n\n\n    private handleShowCustomer(): void {\n        if(this.isShowCustomer) return;\n\n        SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.winSound);\n\n        this.isShowCustomer = true;\n        this.confetti_PS.active = true;\n        this.camera3d.getComponent(PA_06_Camera).goToNewPos();\n    }\n\n\n    protected update(dt: number): void {\n        if (GameInfo.isLose && !this.CTA.active) this.CTA.active = true;\n        if (GameInfo.PA_06.isCameraMoveDone && !this.CTA.active) this.CTA.active = true;\n        if (GameInfo.isWin && !this.isShowCustomer) this.handleShowCustomer();\n    }\n\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/decorator.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}
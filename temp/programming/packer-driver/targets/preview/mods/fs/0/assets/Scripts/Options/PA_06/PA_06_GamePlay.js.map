{"version":3,"sources":["file:///D:/IEC/Testing/Amobear_Supermarket/assets/Scripts/Options/PA_06/PA_06_GamePlay.ts"],"names":["_decorator","Camera","Component","easing","Node","tween","GameInfo","PA_06_Camera","SoundController","CONST","ccclass","property","PA_06_GamePlay","start","handleOpenBox","BoxOpen","Box","getChildByName","boxIdle","active","currentClickBox","Tut2","disableTut","tutIndex","Tut","timeCount","PA_06","isStartPlaying","handleStockTheShelves","currentItemStock","onBoxItems","length","airWorldPos","onAirItems","worldPosition","shelveWorldPos","onShelfItems","currentItem","Instance","PlaySound","SoundTrack","placeSound","to","smooth","delay","call","isDoneStockItem","isWin","handleShowCustomer","isShowCustomer","winSound","confetti_PS","camera3d","getComponent","goToNewPos","update","dt","isLose","CTA","isCameraMoveDone"],"mappings":"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","sourcesContent":["import { _decorator, Camera, Component, easing, fragmentText, Node, SkeletalAnimation, tween } from 'cc';\r\nimport { GameInfo } from '../../Const/GameInfo';\r\nimport { PA_06_Camera } from './PA_06_Camera';\r\nimport { SoundController } from '../../Controller/SoundController';\r\nimport { CONST } from '../../Const/CONST';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = PA_06_GamePlay\r\n * DateTime = Fri Jan 03 2025 10:42:49 GMT+0700 (Indochina Time)\r\n * Author = hoanghiep2001\r\n * FileBasename = PA_06_GamePlay.ts\r\n * FileBasenameNoExtension = PA_06_GamePlay\r\n * URL = db://assets/Scripts/Options/PA_06/PA_06_GamePlay.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\r\n *\r\n */\r\n\r\n@ccclass('PA_06_GamePlay')\r\nexport class PA_06_GamePlay extends Component {\r\n\r\n    @property(Camera)\r\n    camera3d: Camera = null;\r\n\r\n    @property(Node)\r\n    Tut: Node = null;\r\n    @property(Node)\r\n    Tut2: Node = null;\r\n\r\n    @property(Node)\r\n    timeCount: Node = null;\r\n\r\n    @property(Node)\r\n    Box: Node = null;\r\n\r\n    @property([Node])\r\n    onAirItems: Node[] = [];\r\n\r\n    @property([Node])\r\n    onShelfItems: Node[] = [];\r\n\r\n    @property([Node])\r\n    onBoxItems: Node[] = [];\r\n\r\n    @property(Node)\r\n    confetti_PS: Node = null;\r\n\r\n    @property(Node)\r\n    CTA: Node = null;\r\n\r\n\r\n    currentClickBox: number = 0;\r\n    currentItemStock: number = 0;\r\n    isDoneStockItems: boolean = false;\r\n\r\n\r\n    isShowCustomer: boolean = false;\r\n\r\n\r\n    protected start(): void {\r\n        // const boxParent = this.Box.parent;\r\n        // boxParent.getComponent(SkeletalAnimation).play();\r\n        // this.scheduleOnce(() => {\r\n        //     boxParent.getComponent(SkeletalAnimation).stop();\r\n        // }, 0.1);\r\n    }\r\n\r\n\r\n    public handleOpenBox(): void {\r\n        const BoxOpen = this.Box.getChildByName(\"BoxOpen\"),\r\n            boxIdle = this.Box.getChildByName(\"BoxIdle\");\r\n\r\n        BoxOpen.active = true;\r\n        boxIdle.active = false;\r\n\r\n        this.currentClickBox += 1;\r\n        this.Tut2.active = true;\r\n        this.disableTut(this.currentClickBox);\r\n    }\r\n\r\n\r\n    private disableTut(tutIndex: number): void {\r\n        if (tutIndex <= 1) this.Tut.active = false;\r\n        else {\r\n            this.Tut2.active = false\r\n            this.timeCount.active = true;\r\n            GameInfo.PA_06.isStartPlaying = true;\r\n        }\r\n    }\r\n\r\n\r\n    public handleStockTheShelves(): void {\r\n        if (this.currentItemStock >= this.onBoxItems.length) return;\r\n\r\n        const airWorldPos = this.onAirItems[this.currentItemStock].worldPosition;\r\n        const shelveWorldPos = this.onShelfItems[this.currentItemStock].worldPosition;\r\n        const currentItem = this.onBoxItems[this.currentItemStock];\r\n\r\n        this.currentItemStock += 1;\r\n\r\n        SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.placeSound);\r\n\r\n        tween(currentItem)\r\n            .to(0.1, { worldPosition: airWorldPos }, { easing: easing.smooth })\r\n            .start();\r\n\r\n        tween(currentItem)\r\n            .delay(0.1)\r\n            .to(0.1, { worldPosition: shelveWorldPos }, { easing: easing.smooth })\r\n            .call(() => {\r\n                if (this.currentItemStock >= this.onBoxItems.length) {\r\n                    GameInfo.PA_06.isDoneStockItem = true;\r\n                    this.Box.active = false;\r\n                    GameInfo.isWin = true;\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n\r\n    // private showCTA(): void {\r\n    //     GameInfo.isWin = false;\r\n    // }\r\n\r\n\r\n    private handleShowCustomer(): void {\r\n        if(this.isShowCustomer) return;\r\n\r\n        SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.winSound);\r\n\r\n        this.isShowCustomer = true;\r\n        this.confetti_PS.active = true;\r\n        this.camera3d.getComponent(PA_06_Camera).goToNewPos();\r\n    }\r\n\r\n\r\n    protected update(dt: number): void {\r\n        if (GameInfo.isLose && !this.CTA.active) this.CTA.active = true;\r\n        if (GameInfo.PA_06.isCameraMoveDone && !this.CTA.active) this.CTA.active = true;\r\n        if (GameInfo.isWin && !this.isShowCustomer) this.handleShowCustomer();\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/decorator.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}
{"version":3,"sources":["file:///D:/IEC/Testing/Amobear_Supermarket/assets/Scripts/Options/PA_07/GamePlay/PA_07_HideMask.ts"],"names":["_decorator","Camera","Collider","Component","geometry","Node","PhysicsSystem","RigidBody","GameInfo","PA_07_GamePlay","SoundController","GameController","ccclass","property","PA_07_HideMask","start","registerEvent","node","on","EventType","TOUCH_START","touchStart","event","isCanTouch","getRaycastResult","touchPos","ray","Ray","Cam_2D","screenPointToRay","getLocationX","getLocationY","mask","maxDistance","queryTrigger","instance","raycastClosest","raycastClosestResult","collider","name","includes","PA_07","isStockFullBox","Instance","PlaySound","handleStockTheShelves","handleCollectItems","getComponent","enabled","destroy"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Camera, Collider, Component, EventTouch, geometry, log, Node, PhysicsSystem, RigidBody } from 'cc';\r\nimport { PA_07_Camera } from './PA_07_Camera';\r\nimport { IronSource } from '../../../AdHelper/IronSource';\r\nimport { GameInfo } from '../../../Const/GameInfo';\r\nimport { PA_07_GamePlay } from './PA_07_GamePlay';\r\nimport { SoundController } from '../../../Controller/SoundController';\r\nimport { GameController } from '../../../Controller/GameController';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = PA_06_HideMask\r\n * DateTime = Fri Jan 03 2025 10:44:57 GMT+0700 (Indochina Time)\r\n * Author = hoanghiep2001\r\n * FileBasename = PA_06_HideMask.ts\r\n * FileBasenameNoExtension = PA_06_HideMask\r\n * URL = db://assets/Scripts/Options/PA_06/PA_06_HideMask.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/en/\r\n *\r\n */\r\n\r\n@ccclass('PA_07_HideMask')\r\nexport class PA_07_HideMask extends Component {\r\n    @property(GameController)\r\n    GameController: GameController = null;\r\n        \r\n    @property(PA_07_GamePlay)\r\n    PA_07_GamePlay: PA_07_GamePlay = null;\r\n\r\n    @property(Camera)\r\n    Cam_2D: Camera = null;\r\n\r\n\r\n    isClickBoxFirstTime: boolean = false;\r\n\r\n\r\n    protected start(): void {\r\n        this.registerEvent();\r\n    }\r\n\r\n\r\n    private registerEvent(): void {\r\n        this.node.on(Node.EventType.TOUCH_START, this.touchStart, this);\r\n    }\r\n\r\n\r\n    private touchStart(event: EventTouch): void {\r\n        if (!GameInfo.isCanTouch) return;\r\n\r\n        // IronSource.handleIronSourcePlaySound();\r\n\r\n        // if(GameInfo.isToStore || GameInfo.IsShowPopupInstall || GameInfo.currentSuccessClick >= 4) {\r\n        //     this.GameController.installHandle();\r\n        //     return;\r\n        // }\r\n\r\n        this.getRaycastResult(event);\r\n    }\r\n\r\n\r\n    private getRaycastResult(touchPos: EventTouch): void {\r\n        let ray = new geometry.Ray();\r\n        this.Cam_2D.screenPointToRay(touchPos.getLocationX(), touchPos.getLocationY(), ray);\r\n        // The following parameters are optional\r\n        const mask = 0xffffffff;\r\n        const maxDistance = 10000000;\r\n        const queryTrigger = true;\r\n\r\n        if (PhysicsSystem.instance.raycastClosest(ray, mask, maxDistance, queryTrigger)) {\r\n            const raycastClosestResult = PhysicsSystem.instance.raycastClosestResult;\r\n            // const hitPoint = raycastClosestResult.hitPoint\r\n            // const hitNormal = raycastClosestResult.hitNormal;\r\n            const collider = raycastClosestResult.collider;\r\n            // const distance = raycastClosestResult;   \r\n\r\n            if(collider.node.name.includes(\"Box\") && GameInfo.PA_07.isStockFullBox) {\r\n                SoundController.Instance(SoundController).PlaySound(\"placeSound\");\r\n                this.PA_07_GamePlay.handleStockTheShelves();\r\n                return;\r\n            }\r\n\r\n            if (collider.node.name.includes(\"Watermelon\")) {\r\n                this.PA_07_GamePlay.handleCollectItems(collider.node);\r\n\r\n                SoundController.Instance(SoundController).PlaySound(\"placeSound\")\r\n\r\n                collider.node.getComponent(RigidBody).enabled = false;\r\n                collider.node.getComponent(Collider).enabled = false;\r\n                collider.node.getComponent(RigidBody).destroy();\r\n                collider.node.getComponent(Collider).destroy();\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n"]}
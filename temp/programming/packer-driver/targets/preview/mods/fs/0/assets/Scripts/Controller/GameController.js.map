{"version":3,"sources":["file:///D:/CongViec_HocTap/CongTy/Amobear/SupermarketTycoon3D/assets/Scripts/Controller/GameController.ts"],"names":["_decorator","Component","Node","screen","view","SoundController","GameInfo","CONST","ccclass","property","storeURL","GameController","onFinish","window","gameEnd","start","gameReady","handleOrientation","setResizeCallback","Instance","PlaySound","SoundTrack","bgSound","windowSize","width","height","rotatePopup","active","isCanTouch","installHandle","console","log","IsShowPopupInstall","StopAllSound","playableSDK","openAppStore","ExitApi","exit","dapi","openStoreUrl","mraid","cc","sys","os","OS_ANDROID","ANDROID","open","Android","OS_IOS","IPHONE","IPAD","IOS","linkStore","install"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, screen, view } from 'cc';\r\nimport { SoundController } from './SoundController';\r\nimport { GameInfo } from '../Const/GameInfo';\r\nimport { IronSource } from '../AdHelper/IronSource';\r\nimport { CONST } from '../Const/CONST';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\nenum storeURL {\r\n    Android = \"https://play.google.com/store/apps/details?id=com.supermarket.manager.simulator.game\",\r\n    IOS = \"https://apps.apple.com/vn/app/supermarket-tycoon-3d/id6739697316\"\r\n\r\n}\r\n\r\n\r\n@ccclass('GameController')\r\nexport class GameController extends Component {\r\n\r\n    @property(Node)\r\n    rotatePopup: Node = null;\r\n\r\n\r\n    private onFinish(): void {\r\n        window.gameEnd && window.gameEnd();\r\n    }\r\n\r\n\r\n    protected start(): void {\r\n        window.gameReady && window.gameReady();\r\n\r\n        this.handleOrientation();\r\n\r\n        view.setResizeCallback(() => {\r\n            this.handleOrientation();\r\n        });\r\n\r\n        // IronSource.handleMuteSoundIronSource();\r\n\r\n        SoundController.Instance(SoundController).PlaySound(CONST.SoundTrack.bgSound);\r\n    }\r\n\r\n\r\n    private handleOrientation(): void {\r\n        if (screen.windowSize.width > screen.windowSize.height) {\r\n            this.rotatePopup.active = false;\r\n            GameInfo.isCanTouch = true;\r\n        } else {\r\n            this.rotatePopup.active = true;\r\n            GameInfo.isCanTouch = false;\r\n        }\r\n    }\r\n\r\n\r\n    public installHandle(): void {\r\n        console.log(\"install\");\r\n\r\n        // IronSource.isEndGame = true;\r\n        GameInfo.IsShowPopupInstall = true;\r\n        SoundController.Instance(SoundController).StopAllSound();\r\n        window.gameEnd && window.gameEnd();\r\n\r\n        //If ad network is tiktok\r\n        if (typeof (playableSDK) != \"undefined\") {\r\n            window.playableSDK.openAppStore();\r\n            return;\r\n        }\r\n\r\n        // If ad network is google ads\r\n        if (typeof (ExitApi) != \"undefined\") {\r\n            ExitApi.exit();\r\n            return;\r\n        }\r\n\r\n        // If ad netwrok is ironsources\r\n        if (typeof (dapi) != \"undefined\") {\r\n            dapi.openStoreUrl();\r\n            return;\r\n        }\r\n\r\n        // If ad network support MRAID 2.0\r\n        if (typeof (mraid) != \"undefined\") {\r\n            if (cc.sys.os == cc.sys.OS_ANDROID || cc.sys.os == cc.sys.ANDROID) {\r\n                mraid.open(storeURL.Android);\r\n                return;\r\n            }\r\n\r\n            if (cc.sys.os == cc.sys.OS_IOS || cc.sys.os == cc.sys.IPHONE || cc.sys.os == cc.sys.IPAD) {\r\n                mraid.open(storeURL.IOS);\r\n                return;\r\n            }\r\n\r\n            mraid.open(storeURL.Android);\r\n            return;\r\n        }\r\n\r\n        const linkStore = storeURL.Android;\r\n\r\n        // Nếu môi trường hỗ trợ mraid\r\n        // if (typeof mraid !== 'undefined') {\r\n        //     mraid.open(linkStore);\r\n        // }\r\n        // Nếu không, sử dụng cách mở URL thông thường\r\n        if (typeof window !== 'undefined') {\r\n            window.open(linkStore, '_blank'); // Mở link trong tab mới\r\n        }\r\n        // Thêm fallback nếu cần\r\n\r\n        // If ad network is mindwork. window alway avaiable so skip undefined check\r\n        window.install && window.install();\r\n    }\r\n\r\n    // update (deltaTime: number) {\r\n    //     // [4]\r\n    // }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/decorator.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}